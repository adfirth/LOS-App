<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LOS App - Local Testing</title>
    <link rel="stylesheet" href="assets/style.css">
    <style>
        .test-info {
            background: #f0f8ff;
            border: 1px solid #007acc;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            font-family: monospace;
        }
        .test-status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        .status-success { background: #d4edda; color: #155724; }
        .status-error { background: #f8d7da; color: #721c24; }
        .status-warning { background: #fff3cd; color: #856404; }
        .test-results {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .module-test {
            margin: 10px 0;
            padding: 10px;
            border-left: 4px solid #dee2e6;
            background: white;
        }
        .module-test.success { border-left-color: #28a745; }
        .module-test.error { border-left-color: #dc3545; }
        .module-test.warning { border-left-color: #ffc107; }
    </style>
</head>
<body>
    <div class="test-info">
        <h2>üß™ LOS App - Local Testing Environment</h2>
        <p><strong>Status:</strong> <span id="testStatus" class="test-status status-warning">Initializing...</span></p>
        <p><strong>Environment:</strong> <span id="envInfo">Local Development (No Build Required)</span></p>
        <p><strong>Build Time:</strong> <span id="buildTime"></span></p>
        <p><strong>Note:</strong> This is a local testing environment. Changes here won't affect production.</p>
    </div>

    <div id="app">
        <h1>LOS App - Local Testing</h1>
        <div id="testResults"></div>
    </div>

    <script type="module">
        // Local testing environment setup
        window.LOCAL_ENV = {
            RAPIDAPI_KEY: 'local-test-key',
            BUILD_TIME: new Date().toISOString(),
            ENVIRONMENT: 'local-test'
        };

        // Update display
        document.getElementById('buildTime').textContent = new Date().toLocaleString();
        document.getElementById('envInfo').textContent = 'Local Development (No Build Required)';

        // Test module loading
        async function testModules() {
            const testResults = document.getElementById('testResults');
            const status = document.getElementById('testStatus');
            
            try {
                // Test basic module loading
                const modules = [
                    { name: 'UI Module', path: './src/modules/ui.js', critical: true },
                    { name: 'Auth Module', path: './src/modules/auth.js', critical: true },
                    { name: 'Database Module', path: './src/modules/database.js', critical: true },
                    { name: 'Game Logic Module', path: './src/modules/gameLogic.js', critical: false },
                    { name: 'Fixtures Module', path: './src/modules/fixtures.js', critical: false },
                    { name: 'Scores Module', path: './src/modules/scores/index.js', critical: false },
                    { name: 'Admin Module', path: './src/modules/admin/index.js', critical: false }
                ];

                let successCount = 0;
                let criticalFailures = 0;
                const results = [];

                for (const module of modules) {
                    try {
                        // Try to import the module
                        const moduleInstance = await import(module.path);
                        results.push({
                            name: module.name,
                            status: 'success',
                            message: 'Loaded successfully',
                            critical: module.critical
                        });
                        successCount++;
                    } catch (error) {
                        const isCritical = module.critical;
                        if (isCritical) criticalFailures++;
                        
                        results.push({
                            name: module.name,
                            status: 'error',
                            message: error.message,
                            critical: isCritical
                        });
                    }
                }

                // Display results
                let resultsHTML = '<div class="test-results">';
                resultsHTML += '<h3>Module Test Results:</h3>';
                
                results.forEach(result => {
                    const statusClass = result.status === 'success' ? 'success' : 
                                      result.status === 'error' ? 'error' : 'warning';
                    const critical = result.critical ? ' [CRITICAL]' : '';
                    
                    resultsHTML += `
                        <div class="module-test ${statusClass}">
                            <strong>${result.name}${critical}</strong><br>
                            <span class="status-${result.status}">${result.message}</span>
                        </div>
                    `;
                });
                
                resultsHTML += `<p><strong>Success Rate:</strong> ${successCount}/${modules.length} modules loaded</p>`;
                resultsHTML += '</div>';
                
                testResults.innerHTML = resultsHTML;

                // Update status
                if (criticalFailures > 0) {
                    status.textContent = 'Critical Failures';
                    status.className = 'test-status status-error';
                } else if (successCount === modules.length) {
                    status.textContent = 'All Tests Passed';
                    status.className = 'test-status status-success';
                } else {
                    status.textContent = 'Partial Success';
                    status.className = 'test-status status-warning';
                }

                // Log results to console
                console.log('üß™ Local testing environment loaded successfully');
                console.log('üîß Environment:', window.LOCAL_ENV.ENVIRONMENT);
                console.log('üìä Test Results:', results);

            } catch (error) {
                status.textContent = 'Test Error';
                status.className = 'test-status status-error';
                testResults.innerHTML = `<p>‚ùå Error during testing: ${error.message}</p>`;
                console.error('Test Error:', error);
            }
        }

        // Run tests when page loads
        testModules();
    </script>
</body>
</html>
